#!/usr/bin/env python3

from pwn import *
import re

def main():
    HOST = "software-18.challs.olicyber.it"
    PORT = 13001
    r = remote(HOST, PORT)

    # messaggio introduttivo
    r.recvuntil(b" ...")
    r.sendline(b"X")

    for i in range(1,101):
        # step
        data = r.recvline().decode()
        print(data)
        hex_number = re.search(r'0x[0-9a-f]+', data)
        hex_number = hex_number.group()
        int_value = int(hex_number, 16)
        r.recvuntil(b": ")
        if "packed a 64-bit" in data:
            answer = p64(int_value)
        if "packed a 32-bit" in data:
            answer = p32(int_value)
        r.send(answer)
        print(hex_number, int_value, answer)
    print(r.recvline())
    r.close()


if __name__ == "__main__":
    main()
