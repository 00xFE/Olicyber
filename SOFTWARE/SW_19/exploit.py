#!/usr/bin/env python3
from pwn import *

exe = ELF("./sw-19")

if args.REMOTE:
    p = remote("software-19.challs.olicyber.it", 13002)
    # messaggio introduttivo
    p.recvuntil(b" ...")
    p.sendline(b"X")

    for i in range(1,21):
        # spero qualcuno colga la citazione di questo codice
        lettura = p.recvuntil(b": ")
        data = lettura.decode().split(" ")
        real_data = data[1].split(":")
        real_real_data = real_data[0] # nome funzione
        numero_esadecimale = hex(exe.sym[real_real_data])
        print(lettura)
        p.sendline(str(numero_esadecimale).encode())
    print(p.recvline())
else:
    p = process([exe.path])
    # messaggio introduttivo
    p.recvuntil(b" ...")
    p.sendline(b"X")

    for i in range(1,21):
        # spero qualcuno colga la citazione di questo codice
        lettura = p.recvuntil(b": ")
        data = lettura.decode().split(" ")
        real_data = data[1].split(":")
        real_real_data = real_data[0] # nome funzione
        numero_esadecimale = hex(exe.sym[real_real_data])
        print(lettura)
        p.sendline(str(numero_esadecimale).encode())


