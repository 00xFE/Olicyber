#!/usr/bin/env python3

from pwn import *
import re

def main():
    HOST = "software-17.challs.olicyber.it"
    PORT = 13000
    r = remote(HOST, PORT)

    # messaggio introduttivo
    print(r.recvuntil(b" ..."))
    r.sendline(b"X")

    for i in range(1,11):
        # step
        print(r.recvline())
        data = r.recvline().decode("UTF-8")
        data = re.findall(r'-?\d+\.?\d*', data)
        data = list(map(int, data))
        somma = sum(data)
        print(r.recvuntil(b": "))
        r.sendline(str(somma).encode())
    print(r.recvline())
    r.close()


if __name__ == "__main__":
    main()
