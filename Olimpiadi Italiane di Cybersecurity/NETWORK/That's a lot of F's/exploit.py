from scapy.all import *

# apriamo il file pcap
packets = rdpcap("net2.pcap")

# definiamo il protocollo da cercare
protocol = 0xffff

# filtriamo i pacchetti in base al protocollo
filtered_packets = [p for p in packets if p.haslayer(Ether) and p[Ether].type == protocol]

# stampiamo il contenuto dei pacchetti estratti
for p in filtered_packets:
    print(p[Raw].load, end="")
