from scapy.all import *

# Carica il file pcap
packets = rdpcap("CHAOS.pcap")

# Filtra solo i pacchetti TCP
tcp_packets = [p for p in packets if TCP in p]

# Ordina i pacchetti TCP in base al timestamp
tcp_packets_sorted = sorted(tcp_packets, key=lambda p: p.time)

# Estrae il payload TCP da ogni pacchetto
tcp_payloads = [p[TCP].payload for p in tcp_packets_sorted]

# Stampa il payload TCP di ogni pacchetto
for payload in tcp_payloads:
    print(payload)
